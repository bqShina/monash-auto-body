{"version":3,"file":"react-mark-image.cjs.development.js","sources":["../src/types/index.ts","../src/utils/compose.ts","../src/utils/useHandleEscapeEvent.ts","../src/utils/offsetCoordinates.ts","../src/utils/withRelativeMousePos.tsx","../src/components/TextEditor/index.tsx","../src/components/Editor/index.tsx","../src/hocs/SelectorUtils.ts","../src/hocs/RectangleSelector.ts","../src/hocs/PointSelector.ts","../src/hocs/OvalSelector.ts","../src/components/Content/index.tsx","../src/components/Overlay/index.tsx","../src/components/Shapes/withShapeWrapper.tsx","../src/components/Shapes/Oval.tsx","../src/components/Shapes/Point.tsx","../src/components/Shapes/Rectangle.tsx","../src/components/defaultProps.tsx","../src/components/Image/index.tsx","../src/components/ToolBar/ToolBar.tsx","../src/components/Annotation.tsx"],"sourcesContent":["import {\n  ReactElement,\n  MouseEvent,\n  MouseEventHandler,\n  TouchEvent,\n  CSSProperties,\n} from 'react';\n\nexport interface IPoint {\n  x: number;\n  y: number;\n}\n\nexport interface IContainer {\n  height: number;\n  width: number;\n}\n\nexport interface SelectorMethodsOptions {\n  editorMode: EditorMode;\n  idFunction: () => string;\n}\nexport interface ISelectorMethods {\n  onMouseDown?: (\n    annotation: IAnnotation | undefined,\n    e: MouseEvent,\n    options: SelectorMethodsOptions\n  ) => IAnnotation | undefined;\n\n  onMouseUp?: (\n    annotation: IAnnotation | undefined,\n    e: MouseEvent,\n    options: SelectorMethodsOptions\n  ) => IAnnotation | undefined;\n\n  onMouseMove?: (\n    annotation: IAnnotation | undefined,\n    e: MouseEvent,\n    options: SelectorMethodsOptions\n  ) => IAnnotation | undefined;\n\n  onTouchStart?: (\n    annotation: IAnnotation | undefined,\n    e: TouchEvent,\n    options: SelectorMethodsOptions\n  ) => IAnnotation | undefined;\n\n  onTouchEnd?: (\n    annotation: IAnnotation | undefined,\n    e: TouchEvent,\n    options: SelectorMethodsOptions\n  ) => IAnnotation | undefined;\n\n  onTouchMove?: (\n    annotation: IAnnotation | undefined,\n    e: TouchEvent,\n    options: SelectorMethodsOptions\n  ) => IAnnotation | undefined;\n\n  onClick?: (\n    annotation: IAnnotation | undefined,\n    e: any,\n    options: SelectorMethodsOptions\n  ) => IAnnotation | undefined;\n}\n\nexport interface ISelector {\n  TYPE: AllowedShape;\n  intersects: (\n    { x, y }: { x: number; y: number },\n    geometry: IGeometry,\n    container: { width: number; height: number }\n  ) => boolean;\n  area: (\n    geometry: IGeometry,\n    container: { width: number; height: number }\n  ) => number;\n  methods: ISelectorMethods;\n}\n\ninterface AnnotationData extends Record<string, any> {\n  text?: string;\n  id: string;\n}\n\nexport interface IGeometry {\n  type: string;\n  x: number;\n  y: number;\n  height: number;\n  width: number;\n}\n\nexport interface IAnnotation {\n  selection?: {\n    mode: string;\n    anchorX?: number | null;\n    anchorY?: number | null;\n  };\n  geometry: IGeometry;\n  data: AnnotationData;\n}\n\nexport interface RenderEditorProps {\n  annotation: IAnnotation;\n  onSubmit: (e: IAnnotation) => void;\n}\n\nexport interface ShapeProps {\n  annotation: IAnnotation;\n  children?: ReactElement | null;\n  editorMode: EditorMode;\n  isMouseOver: boolean;\n  isSelected: boolean;\n  onMouseEnter: MouseEventHandler<HTMLDivElement>;\n  onMouseLeave: MouseEventHandler<HTMLDivElement>;\n  style?: CSSProperties;\n}\n\nexport interface RenderShapeProps {\n  annotation: IAnnotation;\n  editorMode: EditorMode;\n  key: string;\n  isInSelectionMode: boolean;\n  onAnnotationClick: (annotation: IAnnotation) => void;\n  renderContent?: (props: ContentProps) => ReactElement | null;\n  selectedAnnotation?: IAnnotation;\n}\n\nexport interface ContentProps {\n  key?: string;\n  annotation: IAnnotation;\n}\n\nexport interface RenderSelectorProps {\n  isInSelectionMode: boolean;\n  annotation: IAnnotation;\n  renderContent?: (props: ContentProps) => ReactElement | null;\n}\n\nexport enum EditorMode {\n  AnnotateWithText = 'AnnotateWithText',\n  AnnotateOnly = 'AnnotateOnly',\n  ReadOnlyWithSelection = 'ReadOnlyWithSelection',\n  ReadOnly = 'ReadOnly',\n}\n\nexport enum SelectionMode {\n  New = 'NEW',\n  Selecting = 'SELECTING',\n  Editing = 'EDITING',\n  Final = 'FINAL',\n}\n\nexport type WrappedShapeProps = {\n  annotation: IAnnotation;\n  children?: ReactElement | null;\n  editorMode: EditorMode;\n  isInSelectionMode: boolean;\n  key: string;\n  onAnnotationClick: (annotation: IAnnotation) => void;\n  renderContent?: (props: ContentProps) => ReactElement | null;\n  selectedAnnotation?: IAnnotation;\n  style?: CSSProperties;\n};\n\nexport interface RenderOverlayProps {\n  annotations: IAnnotation[];\n  overlayText?: string;\n  selectorType: string;\n}\n\nexport enum AllowedShape {\n  Oval = 'Oval',\n  Point = 'Point',\n  Rectangle = 'Rectangle',\n}\n\nexport interface RenderToolbarProps {\n  allowedShapes: AllowedShape[];\n  deleteAnnotation: (annotation: IAnnotation) => void;\n  options: ToolBarOptions;\n  selectedAnnotation: IAnnotation | undefined;\n  selectedSelectorType: string;\n  setSelectedSelectorType: (selector: AllowedShape) => void;\n  unSelectSelectedAnnotation: (annotation: IAnnotation) => void;\n}\n\nexport interface RenderSelectedAnnotationIconsProps {\n  annotation: IAnnotation;\n  unSelectAnnotation: () => void;\n}\n\nexport interface ToolBarOptions {\n  showToolBar?: boolean;\n  showDeleteOption?: boolean;\n  renderToolbarIcons?: () => ReactElement | null;\n  renderSelectedAnnotationIcons?: (\n    props: RenderSelectedAnnotationIconsProps\n  ) => ReactElement | null;\n}\n\nexport interface OverlayOptions {\n  displayOverlay?: boolean;\n  overlayText?: string;\n}\n\nexport interface AnnotationProps {\n  src: string;\n  alt?: string;\n  allowedShapes: AllowedShape[];\n\n  annotations: IAnnotation[];\n\n  children?: any;\n  className?: string;\n\n  editorMode: EditorMode;\n\n  idFunction: () => string;\n\n  onAnnotationsUpdate: (annotations: IAnnotation[]) => void;\n  onAnnotationClick: (annotation: IAnnotation) => void;\n  onSelectedAnnotationUpdate: (\n    annotation: IAnnotation,\n    selected: boolean\n  ) => void;\n\n  overlayOptions?: OverlayOptions;\n\n  renderContent: (props: ContentProps) => ReactElement | null;\n  renderEditor: (props: RenderEditorProps) => ReactElement | null;\n  renderShape: (props: WrappedShapeProps) => ReactElement | null;\n  renderOverlay: (props: RenderOverlayProps) => ReactElement | null;\n\n  selectors: ISelector[];\n  style?: object;\n\n  toolBarOptions: ToolBarOptions;\n}\n","export default function compose(...funcs: Function[]) {\n  if (funcs.length === 0) {\n    return (arg: any) => arg;\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(\n    (a, b) =>\n      (...args: any[]) =>\n        a(b(...args))\n  );\n}\n","import { useEffect } from 'react';\nimport { IAnnotation } from '../types/index';\n\nexport default function useHandleEscapeEvent(\n  unselectSelectedAnnotation: () => void,\n  selectedItem?: IAnnotation\n) {\n  useEffect(() => {\n    function handleKeyDown(event: KeyboardEvent) {\n      if (event.key === 'Escape') {\n        unselectSelectedAnnotation();\n      }\n    }\n\n    // Bind the event listener\n    document.addEventListener('keydown', handleKeyDown);\n    return () => {\n      // Unbind the event listener on clean up\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [selectedItem, unselectSelectedAnnotation]);\n}\n","import { MouseEvent, TouchEvent } from 'react';\n\nconst getMouseRelativeCoordinates = (e: MouseEvent) => {\n  // nativeEvent.offsetX gives inconsistent results when dragging\n  // up and to the left rather than the more natural down and to the\n  // right. The reason could be browser implementation (it is still experimental)\n  // or it could be that nativeEvent offsets are based on target rather than\n  // currentTarget.\n  // To keep consistent behavior of the selector use the bounding client rect.\n  const rect = e.currentTarget.getBoundingClientRect();\n  const offsetX = e.clientX - rect.x;\n  const offsetY = e.clientY - rect.y;\n\n  return {\n    x: (offsetX / rect.width) * 100,\n    y: (offsetY / rect.height) * 100,\n  };\n};\n\nconst clamp = (a: number, b: number, i: number) => Math.max(a, Math.min(b, i));\n\nconst getTouchRelativeCoordinates = (\n  e: TouchEvent\n): { x: number; y: number } => {\n  const touch = e.targetTouches[0];\n\n  const boundingRect = e.currentTarget.getBoundingClientRect();\n  // https://idiallo.com/javascript/element-postion\n  // https://stackoverflow.com/questions/25630035/javascript-getboundingclientrect-changes-while-scrolling\n  const offsetX = touch.pageX - boundingRect.left;\n  const offsetY = touch.pageY - (boundingRect.top + window.scrollY);\n\n  return {\n    x: clamp(0, 100, (offsetX / boundingRect.width) * 100),\n    y: clamp(0, 100, (offsetY / boundingRect.height) * 100),\n  };\n};\n\nconst getCoordPercentage = (\n  e: MouseEvent | TouchEvent\n): { x: number; y: number } | undefined => {\n  if (isTouchEvent(e)) {\n    if (isValidTouchEvent(e)) {\n      isTouchMoveEvent(e) && e.preventDefault();\n      return getTouchRelativeCoordinates(e as TouchEvent);\n    }\n    return;\n  } else {\n    return getMouseRelativeCoordinates(e as MouseEvent);\n  }\n};\n\nconst isTouchEvent = (e: any) => e.targetTouches !== undefined;\nconst isValidTouchEvent = (e: any) => e.targetTouches.length === 1;\nconst isTouchMoveEvent = (e: any) => e.type === 'touchmove';\n\nexport {\n  getMouseRelativeCoordinates as getOffsetCoordPercentage,\n  getCoordPercentage,\n};\n","import React, { Component, ComponentType, MouseEvent, TouchEvent } from 'react';\nimport { getOffsetCoordPercentage } from './offsetCoordinates';\n\nexport interface ElementDetails {\n  innerRef: (el: HTMLImageElement) => void;\n  onMouseMove: (e: MouseEvent) => void;\n  onMouseLeave: (e: MouseEvent) => void;\n  onTouchMove: (e: TouchEvent) => void;\n  onTouchLeave: (e: TouchEvent) => void;\n  x: number;\n  y: number;\n}\n\nexport interface WithRelativeMousePosProps {\n  [key: string]: ElementDetails;\n}\nconst withRelativeMousePos =\n  <T extends {}>(key = 'relativeMousePos') =>\n  (DecoratedComponent: ComponentType<T>): ComponentType<T> => {\n    class WithRelativeMousePos extends Component<T> {\n      state = { x: 0, y: 0 };\n      container: HTMLImageElement | undefined;\n\n      innerRef = (el: HTMLImageElement) => {\n        this.container = el;\n      };\n\n      onMouseMove = (e: MouseEvent) => {\n        const xystate = getOffsetCoordPercentage(e);\n        this.setState(xystate);\n      };\n      onTouchMove = (e: TouchEvent) => {\n        if (e.targetTouches.length === 1) {\n          const touch = e.targetTouches[0];\n\n          const offsetX =\n            touch.pageX -\n            (this.container?.offsetParent as HTMLDivElement)?.offsetLeft;\n          const offsetY =\n            touch.pageY -\n            (this.container?.offsetParent as HTMLDivElement)?.offsetTop;\n\n          this.setState({\n            x: (offsetX / this.container!.width) * 100,\n            y: (offsetY / this.container!.height) * 100,\n          });\n        }\n      };\n\n      onMouseLeave = (_e: MouseEvent) => {\n        this.setState({ x: null, y: null });\n      };\n      onTouchLeave = (_e: TouchEvent) => {\n        this.setState({ x: null, y: null });\n      };\n\n      render() {\n        const props = {\n          innerRef: this.innerRef,\n          onMouseMove: this.onMouseMove,\n          onMouseLeave: this.onMouseLeave,\n          onTouchMove: this.onTouchMove,\n          onTouchLeave: this.onTouchLeave,\n          x: this.state.x,\n          y: this.state.y,\n        };\n        const hocProps: WithRelativeMousePosProps = {\n          [key]: props,\n        };\n\n        return <DecoratedComponent {...this.props} {...hocProps} />;\n      }\n    }\n\n    // WithRelativeMousePos.displayName = `withRelativeMousePos(${DecoratedComponent.displayName})`;\n\n    return WithRelativeMousePos;\n  };\n\nexport default withRelativeMousePos;\n","import styled from 'styled-components';\nimport React, { ChangeEvent, FocusEvent, MouseEvent } from 'react';\n\nconst Inner = styled.div`\n  padding: 8px 16px;\n\n  textarea {\n    border: 0;\n    font-size: 14px;\n    margin: 6px 0;\n    min-height: 60px;\n    outline: 0;\n  }\n`;\n\nconst Button = styled.div`\n  background: whitesmoke;\n  border: 0;\n  box-sizing: border-box;\n  color: #363636;\n  cursor: pointer;\n  font-size: 1rem;\n  margin: 0;\n  outline: 0;\n  padding: 8px 16px;\n  text-align: center;\n  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.1);\n  width: 100%;\n\n  transition: background 0.21s ease-in-out;\n\n  &:focus,\n  &:hover {\n    background: #eeeeee;\n  }\n`;\n\nexport interface TextEditorProps {\n  onBlur?: (e: FocusEvent<HTMLTextAreaElement>) => void;\n  onChange?: (e: ChangeEvent<HTMLTextAreaElement>) => void;\n  onFocus?: (e: FocusEvent<HTMLTextAreaElement>) => void;\n  onSubmit?: (e: MouseEvent<HTMLDivElement>) => void;\n  value?: string;\n}\n\nfunction TextEditor(props: TextEditorProps) {\n  return (\n    <React.Fragment>\n      <Inner>\n        <textarea\n          placeholder=\"Write description\"\n          onFocus={props.onFocus}\n          onBlur={props.onBlur}\n          onChange={props.onChange}\n          value={props.value}\n        />\n      </Inner>\n      {props.value && <Button onClick={props.onSubmit}>Submit</Button>}\n    </React.Fragment>\n  );\n}\n\nexport default TextEditor;\n","import React, { ChangeEvent, useState } from 'react';\nimport styled, { keyframes } from 'styled-components';\nimport TextEditor from '../TextEditor';\nimport { IAnnotation } from '../../types/index';\n\nconst fadeInScale = keyframes`\n  from {\n    opacity: 0;\n    transform: scale(0);\n  }\n\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n`;\n\nconst Container = styled.div`\n  background: white;\n  border-radius: 2px;\n  box-shadow: 0 1px 5px 0 rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14),\n    0 3px 1px -2px rgba(0, 0, 0, 0.12);\n  margin-top: 16px;\n  transform-origin: top left;\n\n  animation: ${fadeInScale} 0.31s cubic-bezier(0.175, 0.885, 0.32, 1.275);\n  overflow: hidden;\n  z-index: 2;\n`;\n\ninterface EditorProps {\n  annotation: IAnnotation;\n  className?: string;\n  onSubmit: (e: IAnnotation) => void;\n  style?: object;\n}\n\nfunction Editor(props: EditorProps) {\n  const { geometry } = props.annotation;\n  const [text, setText] = useState('');\n\n  if (!geometry) return null;\n\n  return (\n    <Container\n      className={props.className}\n      style={{\n        position: 'absolute',\n        left: `${geometry.x}%`,\n        top: `${geometry.y + geometry.height}%`,\n        ...props.style,\n      }}\n    >\n      <TextEditor\n        onChange={(e: ChangeEvent<HTMLTextAreaElement>) =>\n          setText(e.target.value)\n        }\n        onSubmit={() => {\n          props.onSubmit({\n            ...props.annotation,\n            data: {\n              ...props.annotation.data,\n              text,\n            },\n          });\n        }}\n        value={text}\n      />\n    </Container>\n  );\n}\n\nexport default Editor;\n","import { MouseEvent, TouchEvent } from 'react';\nimport {\n  EditorMode,\n  IAnnotation,\n  ISelectorMethods,\n  SelectionMode,\n  SelectorMethodsOptions,\n} from '../types';\nimport { getCoordPercentage } from '../utils/offsetCoordinates';\n\nexport function pointerDown(\n  annotation: IAnnotation | undefined,\n  e: TouchEvent | MouseEvent,\n  options: SelectorMethodsOptions,\n  type: string\n): IAnnotation | undefined {\n  const selection = annotation?.selection;\n  if (!selection) {\n    const { x: anchorX, y: anchorY } = getCoordPercentage(e)!;\n\n    return {\n      geometry: {\n        x: 0,\n        y: 0,\n        type,\n        width: 0,\n        height: 0,\n      },\n      selection: {\n        mode: SelectionMode.New,\n        anchorX,\n        anchorY,\n      },\n      data: {\n        id: options.idFunction(),\n      },\n    };\n  }\n  return;\n}\n\nexport function pointerUp(\n  annotation: IAnnotation | undefined,\n  _e: TouchEvent | MouseEvent,\n  editorMode: EditorMode\n): IAnnotation | undefined {\n  if (annotation?.selection) {\n    const { geometry } = annotation;\n    if (!geometry || annotation.selection.mode === SelectionMode.New) {\n      return;\n    }\n    switch (annotation.selection.mode) {\n      case SelectionMode.Selecting:\n        return {\n          ...annotation,\n          selection: {\n            ...annotation.selection,\n            mode:\n              editorMode === EditorMode.AnnotateOnly\n                ? SelectionMode.Final\n                : SelectionMode.Editing,\n          },\n        };\n      default:\n        break;\n    }\n  }\n  return annotation;\n}\n\nexport function pointerMove(\n  annotation: IAnnotation | undefined,\n  e: TouchEvent | MouseEvent\n): IAnnotation | undefined {\n  if (\n    annotation?.selection?.mode === SelectionMode.New ||\n    annotation?.selection?.mode === SelectionMode.Selecting\n  ) {\n    const { anchorX, anchorY } = annotation.selection;\n    const { x: newX, y: newY } = getCoordPercentage(e)!;\n    const width = newX! - anchorX!;\n    const height = newY! - anchorY!;\n\n    const x = width > 0 ? anchorX : newX;\n    const y = height > 0 ? anchorY : newY;\n    return {\n      ...annotation,\n      selection: {\n        ...annotation?.selection,\n        mode: SelectionMode.Selecting,\n      },\n      geometry: {\n        ...annotation.geometry,\n        // Fix types so that these defaults are not needed\n        x: x ?? 0,\n        y: y ?? 0,\n        width: Math.abs(width),\n        height: Math.abs(height),\n      },\n    };\n  }\n  return annotation;\n}\n\nexport const createSelectorMethods = (type: string): ISelectorMethods => ({\n  onMouseDown(\n    annotation: IAnnotation | undefined,\n    e: MouseEvent,\n    options: SelectorMethodsOptions\n  ): IAnnotation | undefined {\n    return pointerDown(annotation, e, options, type);\n  },\n\n  onMouseUp(\n    annotation: IAnnotation | undefined,\n    e: MouseEvent,\n    { editorMode }: SelectorMethodsOptions\n  ): IAnnotation | undefined {\n    return pointerUp(annotation, e, editorMode);\n  },\n\n  onMouseMove(\n    annotation: IAnnotation | undefined,\n    e: MouseEvent\n  ): IAnnotation | undefined {\n    return pointerMove(annotation, e);\n  },\n\n  onTouchStart(\n    annotation: IAnnotation | undefined,\n    e: TouchEvent,\n    options: SelectorMethodsOptions\n  ): IAnnotation | undefined {\n    return pointerDown(annotation, e, options, type);\n  },\n\n  onTouchEnd(\n    annotation: IAnnotation | undefined,\n    e: TouchEvent,\n    { editorMode }: SelectorMethodsOptions\n  ): IAnnotation | undefined {\n    return pointerUp(annotation, e, editorMode);\n  },\n\n  onTouchMove(\n    annotation: IAnnotation | undefined,\n    e: TouchEvent\n  ): IAnnotation | undefined {\n    return pointerMove(annotation, e);\n  },\n});\n","import {\n  AllowedShape,\n  IGeometry,\n  IPoint,\n  ISelector,\n  ISelectorMethods,\n} from '../types/index';\nimport { createSelectorMethods } from './SelectorUtils';\n\nexport const TYPE = AllowedShape.Rectangle;\n\nexport function intersects({ x, y }: IPoint, geometry: IGeometry) {\n  if (x < geometry.x) return false;\n  if (y < geometry.y) return false;\n  if (x > geometry.x + geometry.width) return false;\n  if (y > geometry.y + geometry.height) return false;\n\n  return true;\n}\n\nexport function area(geometry: IGeometry) {\n  return geometry.height * geometry.width;\n}\n\nexport const methods: ISelectorMethods = createSelectorMethods(TYPE);\n\nconst RectangleSelector: ISelector = {\n  TYPE,\n  intersects,\n  area,\n  methods,\n};\n\nexport default RectangleSelector;\n","import { MouseEvent, TouchEvent } from 'react';\nimport {\n  AllowedShape,\n  IAnnotation,\n  IContainer,\n  IGeometry,\n  IPoint,\n  ISelector,\n  ISelectorMethods,\n  SelectionMode,\n  SelectorMethodsOptions,\n} from '../types/index';\nimport { getCoordPercentage } from '../utils/offsetCoordinates';\n\nconst MARGIN = 6;\n\nconst marginToPercentage = (container: IContainer) => ({\n  marginX: (MARGIN / container.width) * 100,\n  marginY: (MARGIN / container.height) * 100,\n});\n\nexport const TYPE = AllowedShape.Point;\n\nexport function intersects(\n  { x, y }: IPoint,\n  geometry: IGeometry,\n  container: IContainer\n) {\n  const { marginX, marginY } = marginToPercentage(container);\n\n  if (x < geometry.x - marginX) return false;\n  if (y < geometry.y - marginY) return false;\n  if (x > geometry.x + marginX) return false;\n  if (y > geometry.y + marginY) return false;\n\n  return true;\n}\n\nexport function area(_geometry: IGeometry, container: IContainer) {\n  const { marginX, marginY } = marginToPercentage(container);\n\n  return marginX * marginY;\n}\n\nexport const methods: ISelectorMethods = {\n  onClick(\n    annotation: IAnnotation | undefined,\n    e: TouchEvent | MouseEvent,\n    options: SelectorMethodsOptions\n  ): IAnnotation | undefined {\n    if (!annotation?.geometry) {\n      return {\n        ...annotation,\n        selection: {\n          mode: SelectionMode.Final,\n        },\n        geometry: {\n          ...getCoordPercentage(e)!,\n          width: 0,\n          height: 0,\n          type: TYPE,\n        },\n        data: {\n          id: options.idFunction(),\n        },\n      };\n    }\n    return;\n  },\n};\n\nconst PointSelector: ISelector = {\n  TYPE,\n  intersects,\n  area,\n  methods,\n};\n\nexport default PointSelector;\n","import {\n  AllowedShape,\n  IGeometry,\n  IPoint,\n  ISelector,\n  ISelectorMethods,\n} from '../types/index';\nimport { createSelectorMethods } from './SelectorUtils';\n\nconst square = (n: number) => Math.pow(n, 2);\n\nexport const TYPE = AllowedShape.Oval;\n\nexport function intersects({ x, y }: IPoint, geometry: IGeometry) {\n  const rx = geometry.width / 2;\n  const ry = geometry.height / 2;\n  const h = geometry.x + rx;\n  const k = geometry.y + ry;\n\n  const value = square(x - h) / square(rx) + square(y - k) / square(ry);\n\n  return value <= 1;\n}\n\nexport function area(geometry: IGeometry) {\n  const rx = geometry.width / 2;\n  const ry = geometry.height / 2;\n\n  return Math.PI * rx * ry;\n}\n\nexport const methods: ISelectorMethods = createSelectorMethods(TYPE);\n\nconst OvalSelector: ISelector = {\n  TYPE,\n  intersects,\n  area,\n  methods,\n};\n\nexport default OvalSelector;\n","import React from 'react';\nimport styled from 'styled-components';\nimport { IAnnotation } from '../../types/index';\n\nconst Container = styled.div`\n  background: white;\n  border-radius: 2px;\n  box-shadow: 0 1px 5px 0 rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14),\n    0 3px 1px -2px rgba(0, 0, 0, 0.12);\n  padding: 8px 16px;\n  margin-top: 8px;\n  margin-left: 8px;\n  z-index: 2;\n`;\n\nexport interface ContentProps {\n  style?: {};\n  className?: '';\n  annotation: IAnnotation;\n}\n\nexport default function Content(props: ContentProps) {\n  const { geometry } = props.annotation;\n  if (!geometry) return null;\n\n  return (\n    <Container\n      style={{\n        position: 'absolute',\n        left: `${geometry.x}%`,\n        top: `${geometry.y + geometry.height}%`,\n        ...props.style,\n      }}\n      className={props.className}\n    >\n      {props.annotation.data && props.annotation.data.text}\n    </Container>\n  );\n}\n","import styled from 'styled-components';\n\nexport default styled.div`\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 5px;\n  bottom: 4px;\n  color: white;\n  font-size: 12px;\n  font-weight: bold;\n  opacity: 0;\n  padding: 10px;\n  pointer-events: none;\n  position: absolute;\n  right: 4px;\n  transition: opacity 0.21s ease-in-out;\n  user-select: none;\n`;\n","import React, { ComponentType, useCallback, useState } from 'react';\nimport { EditorMode, ShapeProps, WrappedShapeProps } from '../../types';\n\nexport const withShapeWrapper = (\n  DecoratedShape: ComponentType<ShapeProps>\n): ComponentType<\n  Omit<WrappedShapeProps, 'isMouseOver' | 'onMouseEnter' | 'onMouseLeave'>\n> => {\n  const WrappedComponent = (props: WrappedShapeProps) => {\n    const {\n      annotation,\n      children,\n      editorMode,\n      isInSelectionMode,\n      renderContent,\n      selectedAnnotation,\n      style,\n    } = props;\n    const [mouseHovered, setMouseHovered] = useState<boolean>(false);\n\n    const shouldShowContent =\n      editorMode === EditorMode.AnnotateWithText &&\n      mouseHovered &&\n      renderContent;\n\n    const reactContentElement =\n      shouldShowContent && props.annotation.data.text && renderContent\n        ? renderContent(props)\n        : null;\n\n    const onMouseEnter = useCallback(() => setMouseHovered(true), []);\n    const onMouseLeave = useCallback(() => setMouseHovered(false), []);\n    const onClick = () => {\n      if (props.onAnnotationClick) {\n        props.onAnnotationClick(annotation);\n      }\n    };\n\n    const shapeStyle = isInSelectionMode\n      ? { zIndex: 0, ...(style || {}) }\n      : style;\n\n    return (\n      <div onClick={onClick}>\n        <DecoratedShape\n          annotation={annotation}\n          children={children}\n          editorMode={editorMode}\n          isMouseOver={mouseHovered}\n          isSelected={\n            !!selectedAnnotation &&\n            annotation.data.id === selectedAnnotation.data.id\n          }\n          onMouseEnter={onMouseEnter}\n          onMouseLeave={onMouseLeave}\n          style={shapeStyle}\n        />\n\n        {reactContentElement}\n      </div>\n    );\n  };\n\n  return WrappedComponent;\n};\n","import React from 'react';\nimport { withShapeWrapper } from './withShapeWrapper';\nimport styled from 'styled-components';\nimport { EditorMode, ShapeProps } from '../../types/index';\n\nconst Container = styled.div`\n  border-radius: 100%;\n  box-shadow: 0 0 2px 2px white inset;\n  box-sizing: border-box;\n  transition: box-shadow 0.21s ease-in-out;\n  z-index: ${({ isReadOnly }: { isReadOnly: boolean }) =>\n    `${isReadOnly ? 0 : 1};`};\n  cursor: ${({ isReadOnly }: { isReadOnly: boolean }) =>\n    isReadOnly ? 'auto;' : 'pointer;'};\n`;\n\nfunction Oval(props: ShapeProps) {\n  const {\n    annotation: { geometry },\n    children,\n    editorMode,\n    isMouseOver,\n    isSelected,\n    onMouseEnter,\n    onMouseLeave,\n  } = props;\n  const isReadOnly = editorMode === EditorMode.ReadOnly;\n\n  if (!geometry) return null;\n\n  const isActive = !isReadOnly && (isMouseOver || isSelected);\n\n  return (\n    <Container\n      isReadOnly={isReadOnly}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      style={{\n        position: 'absolute',\n        left: `${geometry.x}%`,\n        top: `${geometry.y}%`,\n        height: `${geometry.height}%`,\n        width: `${geometry.width}%`,\n        border: isActive ? 'solid 1px black' : 'dashed 2px black',\n        boxShadow: isActive ? '0 0 1px 1px black inset' : '',\n        backgroundColor: isActive\n          ? 'rgba(128, 128, 128, 0.3)'\n          : 'rgba(128, 128, 128, 0.05)',\n        ...(props.style || {}),\n      }}\n    >\n      {children || null}\n    </Container>\n  );\n}\n\nexport default React.memo(withShapeWrapper(Oval));\n","import React from 'react';\nimport styled from 'styled-components';\nimport { EditorMode, ShapeProps } from '../../types/index';\nimport { withShapeWrapper } from './withShapeWrapper';\n\nconst Container = styled.div`\n  border-radius: 50%;\n  box-sizing: border-box;\n  // prettier-ignore\n  box-shadow: \n          0 0 0 1px rgba(0, 0, 0, 0.3),\n          0 0 0 2px rgba(0, 0, 0, 0.2),\n          0 5px 4px rgba(0, 0, 0, 0.4);\n  height: 16px;\n  position: absolute;\n  transform: translate3d(-50%, -50%, 0);\n  width: 16px;\n  z-index: ${({ isReadOnly }: { isReadOnly: boolean }) =>\n    `${isReadOnly ? 0 : 1};`};\n  cursor: ${({ isReadOnly }: { isReadOnly: boolean }) =>\n    isReadOnly ? 'auto;' : 'pointer;'};\n`;\n\nfunction Point(props: ShapeProps) {\n  const {\n    annotation: { geometry },\n    children,\n    editorMode,\n    isMouseOver,\n    isSelected,\n    onMouseEnter,\n    onMouseLeave,\n  } = props;\n  const isReadOnly = editorMode === EditorMode.ReadOnly;\n\n  if (!geometry) return null;\n\n  const isActive = !isReadOnly && (isMouseOver || isSelected);\n\n  return (\n    <Container\n      isReadOnly={isReadOnly}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      style={{\n        top: `${geometry.y}%`,\n        left: `${geometry.x}%`,\n        border: isActive ? 'solid 3px grey' : 'solid 3px white',\n        ...(props.style || {}),\n      }}\n    >\n      {children || null}\n    </Container>\n  );\n}\n\nexport default React.memo(withShapeWrapper(Point));\n","import React from 'react';\nimport styled from 'styled-components';\nimport { EditorMode, ShapeProps } from '../../types/index';\nimport { withShapeWrapper } from './withShapeWrapper';\n\nconst Container = styled.div`\n  box-shadow: 0 0 2px 2px white inset;\n  box-sizing: border-box;\n  transition: box-shadow 0.21s ease-in-out;\n  z-index: ${({ isReadOnly }: { isReadOnly: boolean }) =>\n    `${isReadOnly ? 0 : 1};`};\n  cursor: ${({ isReadOnly }: { isReadOnly: boolean }) =>\n    isReadOnly ? 'auto;' : 'pointer;'};\n`;\n\nfunction Rectangle(props: ShapeProps) {\n  const {\n    annotation: { geometry },\n    children,\n    editorMode,\n    isMouseOver,\n    isSelected,\n    onMouseEnter,\n    onMouseLeave,\n  } = props;\n  const isReadOnly = editorMode === EditorMode.ReadOnly;\n\n  if (!geometry) return null;\n\n  const isActive = !isReadOnly && (isMouseOver || isSelected);\n\n  return (\n    <Container\n      isReadOnly={isReadOnly}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      style={{\n        position: 'absolute',\n        left: `${geometry.x}%`,\n        top: `${geometry.y}%`,\n        height: `${geometry.height}%`,\n        width: `${geometry.width}%`,\n        border: isActive ? 'solid 1px black' : 'dashed 2px black',\n        boxShadow: isActive ? '0 0 1px 1px black inset' : '',\n        backgroundColor: isActive\n          ? 'rgba(128, 128, 128, 0.3)'\n          : 'rgba(128, 128, 128, 0.05)',\n        ...(props.style || {}),\n      }}\n    >\n      {children || null}\n    </Container>\n  );\n}\n\nexport default React.memo(withShapeWrapper(Rectangle));\n","import Editor from './Editor';\nimport React, { ReactElement } from 'react';\n\nimport { OvalSelector, PointSelector, RectangleSelector } from '../selectors';\nimport {\n  AnnotationProps,\n  ContentProps,\n  EditorMode,\n  RenderEditorProps,\n  RenderShapeProps,\n  RenderOverlayProps,\n} from './../types/index';\nimport Content from './Content';\nimport Overlay from './Overlay';\nimport Oval from './Shapes/Oval';\nimport Point from './Shapes/Point';\nimport Rectangle from './Shapes/Rectangle';\n\nconst defaultProps: AnnotationProps = {\n  src: '',\n\n  annotations: [],\n  editorMode: EditorMode.AnnotateWithText,\n\n  idFunction: () => Math.random().toString(),\n\n  onAnnotationsUpdate: () => {},\n  onAnnotationClick: () => {},\n  onSelectedAnnotationUpdate: () => {},\n\n  overlayOptions: {\n    displayOverlay: true,\n  },\n\n  renderEditor: ({ annotation, onSubmit }: RenderEditorProps) => (\n    <Editor annotation={annotation} onSubmit={onSubmit} />\n  ),\n\n  renderShape: (props: RenderShapeProps): ReactElement | null => {\n    const { annotation } = props;\n    switch (annotation.geometry.type) {\n      case RectangleSelector.TYPE:\n        return <Rectangle {...props} />;\n      case PointSelector.TYPE:\n        return <Point {...props} />;\n      case OvalSelector.TYPE:\n        return <Oval {...props} />;\n      default:\n        return null;\n    }\n  },\n\n  renderContent: ({ key, annotation }: ContentProps) => (\n    <Content key={key} annotation={annotation} />\n  ),\n\n  renderOverlay: ({\n    annotations,\n    selectorType,\n    overlayText,\n  }: RenderOverlayProps): ReactElement => {\n    if (overlayText) {\n      return <Overlay>{overlayText}</Overlay>;\n    }\n    if (annotations.length === 0) {\n      switch (selectorType) {\n        case PointSelector.TYPE:\n          return <Overlay>Click to Annotate</Overlay>;\n        default:\n          return <Overlay>Click and Drag to Annotate</Overlay>;\n      }\n    } else {\n      return <Overlay>Select the annotation for additional options</Overlay>;\n    }\n  },\n\n  selectors: [RectangleSelector, PointSelector, OvalSelector],\n\n  allowedShapes: [\n    RectangleSelector.TYPE,\n    OvalSelector.TYPE,\n    PointSelector.TYPE,\n  ],\n\n  toolBarOptions: {\n    showDeleteOption: true,\n    showToolBar: true,\n    renderSelectedAnnotationIcons: () => null,\n    renderToolbarIcons: () => null,\n  },\n};\nexport default defaultProps;\n","import React, { useRef } from 'react';\nimport styled from 'styled-components';\n\nconst Img = styled.img`\n  display: block;\n  width: 100%;\n`;\n\ninterface ImageProps {\n  alt?: string;\n  draggable?: boolean;\n  src: string;\n  style?: object;\n}\n\nexport default function Image(props: ImageProps) {\n  const imageRef = useRef<HTMLImageElement>(null);\n\n  const { alt, draggable, src, style } = props;\n  return (\n    <Img\n      alt={alt}\n      draggable={draggable}\n      ref={imageRef}\n      src={src}\n      style={style}\n    />\n  );\n}\n","import React, { ReactElement } from 'react';\nimport styled from 'styled-components';\nimport { AllowedShape, RenderToolbarProps } from '../../types/index';\nimport BackSvg from './icons/arrowLeft.svg';\nimport CircleSvg from './icons/circle.svg';\nimport PointSvg from './icons/point.svg';\nimport SquareSvg from './icons/square.svg';\nimport TrashSvg from './icons/trash.svg';\n\nconst ToolbarDiv = styled.div`\n  border: 1px solid #ccc;\n  background-color: #efefef;\n  width: 100%;\n  display: flex;\n`;\n\nconst StyledIcon = styled.a`\n  border-right: 1px solid #ccc;\n  width: 40px;\n  height: 40px;\n  background-repeat: no-repeat;\n  background-position: center;\n  cursor: pointer;\n  background-color: ${({ isSelected }: { isSelected: boolean }) =>\n    isSelected ? '#ccc' : '#efefef'};\n`;\n\nconst CircleIcon = styled(StyledIcon)`\n  background-image: url(${CircleSvg});\n`;\nconst PointIcon = styled(StyledIcon)`\n  background-image: url(${PointSvg});\n`;\nconst SquareIcon = styled(StyledIcon)`\n  background-image: url(${SquareSvg});\n`;\nconst BackIcon = styled(StyledIcon)`\n  background-image: url(${BackSvg});\n`;\nconst TrashIcon = styled(StyledIcon)`\n  background-image: url(${TrashSvg});\n`;\n\nexport default function ToolBar({\n  allowedShapes,\n  deleteAnnotation,\n  options,\n  selectedAnnotation,\n  selectedSelectorType,\n  setSelectedSelectorType,\n  unSelectSelectedAnnotation,\n}: RenderToolbarProps): ReactElement | null {\n  return options.showToolBar ? (\n    <ToolbarDiv>\n      {selectedAnnotation ? (\n        <>\n          <BackIcon\n            isSelected={false}\n            onClick={() => unSelectSelectedAnnotation(selectedAnnotation)}\n          />\n          {options.renderSelectedAnnotationIcons?.({\n            annotation: selectedAnnotation,\n            unSelectAnnotation: () =>\n              unSelectSelectedAnnotation(selectedAnnotation),\n          })}\n          <TrashIcon\n            isSelected={false}\n            onClick={() => deleteAnnotation(selectedAnnotation)}\n          />\n        </>\n      ) : (\n        <>\n          {allowedShapes.includes(AllowedShape.Rectangle) ? (\n            <SquareIcon\n              isSelected={selectedSelectorType === AllowedShape.Rectangle}\n              onClick={() => setSelectedSelectorType(AllowedShape.Rectangle)}\n            />\n          ) : null}\n          {allowedShapes.includes(AllowedShape.Oval) ? (\n            <CircleIcon\n              isSelected={selectedSelectorType === AllowedShape.Oval}\n              onClick={() => setSelectedSelectorType(AllowedShape.Oval)}\n            />\n          ) : null}\n          {allowedShapes.includes(AllowedShape.Point) ? (\n            <PointIcon\n              isSelected={selectedSelectorType === AllowedShape.Point}\n              onClick={() => setSelectedSelectorType(AllowedShape.Point)}\n            />\n          ) : null}\n        </>\n      )}\n    </ToolbarDiv>\n  ) : null;\n}\n","import React, {\n  ComponentType,\n  MouseEvent,\n  TouchEvent,\n  useCallback,\n  useEffect,\n  useState,\n} from 'react';\nimport styled from 'styled-components';\nimport {\n  AnnotationProps,\n  EditorMode,\n  IAnnotation,\n  ISelector,\n  SelectionMode,\n} from '../types/index';\nimport compose from '../utils/compose';\nimport useHandleEscapeEvent from '../utils/useHandleEscapeEvent';\nimport withRelativeMousePos, {\n  WithRelativeMousePosProps,\n} from '../utils/withRelativeMousePos';\n\nimport defaultProps from './defaultProps';\nimport ImageElement from './Image';\nimport Overlay from './Overlay';\nimport ToolBar from './ToolBar/ToolBar';\n\nconst Container = styled.div`\n  clear: both;\n  position: relative;\n  width: 100%;\n\n  &:hover ${Overlay} {\n    opacity: 1;\n  }\n`;\n\nconst ItemsDiv = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n`;\n\nconst ReadOnlyDiv = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n`;\n\nexport type AnnotationPropsOptional = {\n  [K in keyof AnnotationProps]?: AnnotationProps[K]; // so that it retains the types\n};\n\nfunction Annotation(options: AnnotationProps & WithRelativeMousePosProps) {\n  const props: AnnotationProps = {\n    ...defaultProps,\n    ...options,\n  };\n\n  const allowTouch = false;\n  const {\n    allowedShapes,\n\n    alt,\n    className,\n\n    editorMode,\n\n    idFunction,\n\n    onSelectedAnnotationUpdate,\n    onAnnotationClick: onAnnotationClickProp,\n\n    overlayOptions,\n\n    renderShape,\n    renderEditor,\n    renderOverlay,\n\n    style,\n    src,\n\n    toolBarOptions,\n  } = props;\n\n  const [selectedSelectorType, setSelectedSelectorType] = useState<string>(\n    props.allowedShapes[0]\n  );\n\n  // This annotation is set when adding a new annotation. The state is cleared after annotation is added\n  const [selectedAnnotation, setSelectedAnnotation] = useState<\n    IAnnotation | undefined\n  >();\n\n  // This annotation is set when adding a new annotation. The state is cleared after annotation is added\n  const [tmpAnnotation, setTmpAnnotation] = useState<IAnnotation | undefined>();\n\n  const [annotations, setAnnotations] = useState<IAnnotation[]>(\n    options.annotations\n  );\n\n  useEffect(() => {\n    setAnnotations(options.annotations);\n  }, [options.annotations]);\n\n  const [showEditor, setShowEditor] = useState<boolean>(false);\n\n  const targetRef = React.createRef<any>();\n\n  const addTargetTouchEventListeners = () => {\n    // Safari does not recognize touch-action CSS property,\n    // so we need to call preventDefault ourselves to stop touch from scrolling\n    // Event handlers must be set via ref to enable e.preventDefault()\n    // https://github.com/facebook/react/issues/9809\n\n    targetRef.current.ontouchstart = onTouchStart;\n    targetRef.current.ontouchend = onTouchEnd;\n    targetRef.current.ontouchmove = onTargetTouchMove;\n    targetRef.current.ontouchcancel = onTargetTouchLeave;\n  };\n  const removeTargetTouchEventListeners = () => {\n    targetRef.current.ontouchstart = undefined;\n    targetRef.current.ontouchend = undefined;\n    targetRef.current.ontouchmove = undefined;\n    targetRef.current.ontouchcancel = undefined;\n  };\n\n  const isInEditMode =\n    editorMode !== EditorMode.ReadOnly &&\n    editorMode !== EditorMode.ReadOnlyWithSelection;\n\n  useEffect(() => {\n    if (isInEditMode) {\n      if (allowTouch) {\n        addTargetTouchEventListeners();\n      } else {\n        removeTargetTouchEventListeners();\n      }\n    }\n  });\n\n  const getSelectorByType = (type: string): ISelector => {\n    return props.selectors.find((s) => s.TYPE === type)!;\n  };\n\n  const onTargetMouseMove = (e: MouseEvent) => {\n    options.relativeMousePos.onMouseMove(e);\n    onMouseMove(e);\n  };\n  const onTargetTouchMove = (e: TouchEvent) => {\n    options.relativeMousePos.onTouchMove(e);\n    onTouchMove(e);\n  };\n\n  const onTargetMouseLeave = (e: MouseEvent) => {\n    options.relativeMousePos.onMouseLeave(e);\n  };\n  const onTargetTouchLeave = (e: TouchEvent) => {\n    options.relativeMousePos.onTouchLeave(e);\n  };\n\n  const onMouseUp = (e: MouseEvent) => callSelectorMethod('onMouseUp', e);\n  const onMouseDown = (e: MouseEvent) => callSelectorMethod('onMouseDown', e);\n  const onMouseMove = (e: MouseEvent) => callSelectorMethod('onMouseMove', e);\n  const onTouchStart = (e: TouchEvent) => callSelectorMethod('onTouchStart', e);\n  const onTouchEnd = (e: TouchEvent) => callSelectorMethod('onTouchEnd', e);\n  const onTouchMove = (e: TouchEvent) => callSelectorMethod('onTouchMove', e);\n\n  const onClick = (e: MouseEvent) => {\n    unselectSelectedAnnotation();\n\n    callSelectorMethod('onClick', e);\n  };\n\n  const onAnnotationFinal = (annotation: IAnnotation) => {\n    const newAnnotationArray = [...annotations, annotation];\n    setAnnotations(newAnnotationArray);\n    options.onAnnotationsUpdate(newAnnotationArray);\n    setTmpAnnotation(undefined);\n  };\n\n  const callSelectorMethod = (\n    methodName:\n      | 'onMouseUp'\n      | 'onMouseDown'\n      | 'onMouseMove'\n      | 'onTouchStart'\n      | 'onTouchEnd'\n      | 'onTouchMove'\n      | 'onClick',\n    e: MouseEvent | TouchEvent\n  ) => {\n    const { editorMode } = props;\n\n    if (!!options[methodName]) {\n      (options[methodName] as any)(e);\n    } else {\n      const selector = getSelectorByType(selectedSelectorType);\n      const selectorMethod = selector.methods[methodName];\n      if (selectorMethod) {\n        const value: IAnnotation | undefined = selectorMethod(\n          tmpAnnotation,\n          e,\n          { editorMode, idFunction }\n        );\n\n        setTmpAnnotation(value);\n        switch (value?.selection?.mode) {\n          case SelectionMode.Final:\n            onAnnotationFinal(value);\n            setShowEditor(true);\n            break;\n          case SelectionMode.Editing:\n            setShowEditor(true);\n            break;\n          default:\n            setTmpAnnotation(value);\n            setShowEditor(true);\n            break;\n        }\n      }\n    }\n  };\n\n  const deleteAnnotation = (annotationToDelete: IAnnotation) => {\n    const filtered = annotations.filter(\n      (annotation) => annotation.data.id !== annotationToDelete.data.id\n    );\n    const newAnnotationsValue = [...filtered];\n    setAnnotations(newAnnotationsValue);\n    setSelectedAnnotation(undefined);\n    props.onAnnotationsUpdate(newAnnotationsValue);\n  };\n\n  const unselectSelectedAnnotation = () => {\n    if (selectedAnnotation) {\n      setSelectedAnnotation(undefined);\n      onSelectedAnnotationUpdate(selectedAnnotation, false);\n    }\n  };\n\n  const onAnnotationClick = useCallback(\n    (annotation: IAnnotation) => {\n      setSelectedAnnotation(annotation);\n      onSelectedAnnotationUpdate(annotation, true);\n      onAnnotationClickProp(annotation);\n    },\n    [onAnnotationClickProp, onSelectedAnnotationUpdate]\n  );\n\n  useHandleEscapeEvent(unselectSelectedAnnotation, selectedAnnotation);\n  return (\n    <div className={className}>\n      {isInEditMode && (\n        <ToolBar\n          allowedShapes={allowedShapes}\n          deleteAnnotation={deleteAnnotation}\n          options={toolBarOptions}\n          selectedAnnotation={selectedAnnotation}\n          selectedSelectorType={selectedSelectorType}\n          setSelectedSelectorType={setSelectedSelectorType}\n          unSelectSelectedAnnotation={unselectSelectedAnnotation}\n        />\n      )}\n      <Container\n        style={{\n          ...props.style,\n          touchAction: allowTouch ? 'pinch-zoom' : 'auto',\n        }}\n        onMouseLeave={onTargetMouseLeave}\n        onTouchCancel={onTargetTouchLeave}\n      >\n        <ImageElement style={style} alt={alt} src={src} draggable={false} />\n        <ItemsDiv>\n          {annotations.map((annotation) =>\n            renderShape({\n              annotation: annotation,\n              editorMode: props.editorMode,\n              isInSelectionMode: !!tmpAnnotation,\n              key: annotation.data.id,\n              renderContent: props.renderContent,\n              onAnnotationClick: onAnnotationClick,\n              selectedAnnotation: selectedAnnotation,\n            })\n          )}\n          {tmpAnnotation?.geometry &&\n            renderShape({\n              annotation: tmpAnnotation,\n              editorMode: props.editorMode,\n              isInSelectionMode: !!tmpAnnotation,\n              key: tmpAnnotation.data.id,\n              renderContent: props.renderContent,\n              onAnnotationClick: onAnnotationClick,\n            })}\n        </ItemsDiv>\n        {isInEditMode ? (\n          <ItemsDiv\n            onClick={onClick}\n            onMouseUp={onMouseUp}\n            onMouseDown={onMouseDown}\n            onMouseMove={onTargetMouseMove}\n            ref={targetRef}\n          />\n        ) : (\n          <ReadOnlyDiv onClick={unselectSelectedAnnotation} />\n        )}\n        {isInEditMode &&\n          overlayOptions?.displayOverlay &&\n          renderOverlay({\n            annotations,\n            overlayText: overlayOptions?.overlayText,\n            selectorType: selectedSelectorType,\n          })}\n        {showEditor &&\n          tmpAnnotation &&\n          tmpAnnotation.selection?.mode === SelectionMode.Editing &&\n          renderEditor({\n            annotation: tmpAnnotation,\n            onSubmit: onAnnotationFinal,\n          })}\n        <div>{props.children}</div>\n      </Container>\n    </div>\n  );\n}\n\nconst WrappedAnnotation: ComponentType<AnnotationPropsOptional> = compose(\n  withRelativeMousePos()\n)(Annotation);\n\nexport default WrappedAnnotation;\n"],"names":["EditorMode","SelectionMode","AllowedShape","compose","funcs","length","arg","reduce","a","b","useHandleEscapeEvent","unselectSelectedAnnotation","selectedItem","useEffect","handleKeyDown","event","key","document","addEventListener","removeEventListener","getMouseRelativeCoordinates","e","rect","currentTarget","getBoundingClientRect","offsetX","clientX","x","offsetY","clientY","y","width","height","clamp","i","Math","max","min","getTouchRelativeCoordinates","touch","targetTouches","boundingRect","pageX","left","pageY","top","window","scrollY","getCoordPercentage","isTouchEvent","isValidTouchEvent","isTouchMoveEvent","preventDefault","undefined","type","withRelativeMousePos","DecoratedComponent","WithRelativeMousePos","el","container","xystate","getOffsetCoordPercentage","setState","offsetParent","offsetLeft","offsetTop","_e","render","props","innerRef","onMouseMove","onMouseLeave","onTouchMove","onTouchLeave","state","hocProps","React","Component","Inner","styled","div","Button","TextEditor","Fragment","placeholder","onFocus","onBlur","onChange","value","onClick","onSubmit","fadeInScale","keyframes","Container","Editor","geometry","annotation","useState","text","setText","className","style","position","target","data","pointerDown","options","selection","anchorX","anchorY","mode","New","id","idFunction","pointerUp","editorMode","Selecting","AnnotateOnly","Final","Editing","pointerMove","newX","newY","abs","createSelectorMethods","onMouseDown","onMouseUp","onTouchStart","onTouchEnd","TYPE","Rectangle","intersects","area","methods","RectangleSelector","MARGIN","marginToPercentage","marginX","marginY","Point","_geometry","PointSelector","square","n","pow","Oval","rx","ry","h","k","PI","OvalSelector","Content","withShapeWrapper","DecoratedShape","WrappedComponent","children","isInSelectionMode","renderContent","selectedAnnotation","mouseHovered","setMouseHovered","shouldShowContent","AnnotateWithText","reactContentElement","onMouseEnter","useCallback","onAnnotationClick","shapeStyle","zIndex","isMouseOver","isSelected","isReadOnly","ReadOnly","isActive","border","boxShadow","backgroundColor","memo","defaultProps","src","annotations","random","toString","onAnnotationsUpdate","onSelectedAnnotationUpdate","overlayOptions","displayOverlay","renderEditor","renderShape","renderOverlay","selectorType","overlayText","Overlay","selectors","allowedShapes","toolBarOptions","showDeleteOption","showToolBar","renderSelectedAnnotationIcons","renderToolbarIcons","Img","img","Image","imageRef","useRef","alt","draggable","ref","ToolbarDiv","StyledIcon","CircleIcon","CircleSvg","PointIcon","PointSvg","SquareIcon","SquareSvg","BackIcon","BackSvg","TrashIcon","TrashSvg","ToolBar","deleteAnnotation","selectedSelectorType","setSelectedSelectorType","unSelectSelectedAnnotation","unSelectAnnotation","includes","ItemsDiv","ReadOnlyDiv","Annotation","onAnnotationClickProp","setSelectedAnnotation","tmpAnnotation","setTmpAnnotation","setAnnotations","showEditor","setShowEditor","targetRef","createRef","removeTargetTouchEventListeners","current","ontouchstart","ontouchend","ontouchmove","ontouchcancel","isInEditMode","ReadOnlyWithSelection","getSelectorByType","find","s","onTargetMouseMove","relativeMousePos","onTargetMouseLeave","onTargetTouchLeave","callSelectorMethod","onAnnotationFinal","newAnnotationArray","methodName","selector","selectorMethod","annotationToDelete","filtered","filter","newAnnotationsValue","touchAction","allowTouch","onTouchCancel","ImageElement","map","WrappedAnnotation"],"mappings":"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"}